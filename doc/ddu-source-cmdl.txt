*ddu-source-cmdl.txt*	Command list source and kind for ddu.vim

Author:  KMNK
License: MIT License

Generated with Claude Code assistance (https://claude.com/claude-code)

==============================================================================
CONTENTS					*ddu-source-cmdl-contents*

Introduction		|ddu-source-cmdl-introduction|
Install			|ddu-source-cmdl-install|
Source			|ddu-source-cmdl-source|
  Source Params		|ddu-source-cmdl-source-params|
Kind			|ddu-source-cmdl-kind|
  Kind Actions		|ddu-source-cmdl-kind-actions|
Functions		|ddu-source-cmdl-functions|
Data Format		|ddu-source-cmdl-data-format|
Examples		|ddu-source-cmdl-examples|

==============================================================================
INTRODUCTION					*ddu-source-cmdl-introduction*

ddu-source-cmdl provides a ddu.vim source and kind for managing a personal
list of labeled Vim commands. Each entry pairs a human-readable label with a
Vim Ex command. Entries are persisted to a JSON file and can be registered,
edited, deleted, and executed through the ddu.vim interface.

Requirements:
- denops.vim  https://github.com/vim-denops/denops.vim
- ddu.vim     https://github.com/Shougo/ddu.vim

==============================================================================
INSTALL						*ddu-source-cmdl-install*

Install with your preferred plugin manager.

vim-plug: >
	Plug 'kmnk/ddu-source-cmdl'
<
lazy.nvim: >
	{
	  'kmnk/ddu-source-cmdl',
	  dependencies = {
	    'Shougo/ddu.vim',
	    'vim-denops/denops.vim',
	  },
	}
<
==============================================================================
SOURCE						*ddu-source-cmdl-source*

Name: `cmdl`

Reads entries from the data file and enqueues them as ddu items. The item
`word` is set to the entry label. When no entries are registered a single
placeholder row is shown so that kind actions (e.g. `add`) remain accessible.

Each item carries the following display format: >
	{label}<Tab>{command}
<
------------------------------------------------------------------------------
SOURCE PARAMS				*ddu-source-cmdl-source-params*

						*ddu-source-cmdl-param-highlights*
highlights
	A dictionary of Vim highlight group names applied to parts of each
	item. Set a key to `""` to disable that highlight.

	highlights.command			(default: `"Comment"`)
		Applied to the command column (text after the tab separator).
		Dimmed by default so the label stands out as the primary text.

	highlights.placeholder			(default: `"Comment"`)
		Applied to the empty-state placeholder row.

	Example: >
		call ddu#start(#{
		\   sources: [#{
		\     name: 'cmdl',
		\     params: #{highlights: #{command: 'Statement'}},
		\   }],
		\ })
<
==============================================================================
KIND						*ddu-source-cmdl-kind*

Name: `cmdl`

Defines actions on cmdl items. Set `defaultAction` to `"execute"` to run
the registered command when pressing <CR>: >

	call ddu#start(#{
	\   sources: [#{name: 'cmdl'}],
	\   kindOptions: #{
	\     cmdl: #{defaultAction: 'execute'},
	\   },
	\ })
<
------------------------------------------------------------------------------
KIND ACTIONS				*ddu-source-cmdl-kind-actions*

						*ddu-source-cmdl-action-execute*
execute
	Execute the registered Vim Ex command of each selected item.
	Iterates over all selected items in order.
	Placeholder items are silently skipped.

						*ddu-source-cmdl-action-add*
add
	Prompt for a label and a command, then append a new entry to the
	data file. The currently selected item is ignored; this action can
	be called even when the list is empty.
	Refreshes the item list on success.
	An empty input cancels the action without saving.

						*ddu-source-cmdl-action-edit*
edit
	Prompt to update the label and command of the first selected entry.
	Current values are pre-filled in the input prompt.
	Refreshes the item list on success.
	An empty input cancels the action without saving.

						*ddu-source-cmdl-action-delete*
delete
	Ask for confirmation and then delete all selected entries from the
	data file. Placeholder items are excluded from the count and are
	not deleted. Supports multi-item deletion.
	Refreshes the item list on success.

==============================================================================
FUNCTIONS					*ddu-source-cmdl-functions*

						*ddu_source_cmdl#set_data_directory_path()*
ddu_source_cmdl#set_data_directory_path({path})
	Set the directory used to store the command list data file
	(`cmdl.json`). {path} may contain `~` which is expanded at access
	time. The default value is `~/.cache/ddu-source-cmdl`.

	The data file is created automatically the first time an entry is
	added.

	Example: >
		call ddu_source_cmdl#set_data_directory_path(
		\   '~/.local/share/cmdl'
		\ )
<
						*ddu_source_cmdl#get_data_directory_path()*
ddu_source_cmdl#get_data_directory_path()
	Return the absolute path to the configured data directory.
	Called internally by the source and kind; rarely needed directly.

==============================================================================
DATA FORMAT					*ddu-source-cmdl-data-format*

Entries are stored as a JSON array at `{data-dir}/cmdl.json`. Each element
is an object with two string fields:

	label	Human-readable name shown in the ddu UI.
	command	Vim Ex command executed by the `execute` action.

Example (`~/.cache/ddu-source-cmdl/cmdl.json`): >

	[
	  {
	    "label": "Open vimrc",
	    "command": "edit $MYVIMRC"
	  },
	  {
	    "label": "Source vimrc",
	    "command": "source $MYVIMRC"
	  },
	  {
	    "label": "Clear registers",
	    "command": "for i in range(34,122) | silent! call setreg(nr2char(i), []) | endfor"
	  }
	]
<
The file and its parent directory are created automatically on the first
successful `add` action.

==============================================================================
EXAMPLES					*ddu-source-cmdl-examples*

Basic setup with ddu-ui-ff: >

	" Change data directory (optional)
	call ddu_source_cmdl#set_data_directory_path('~/.local/share/cmdl')

	" Open the command list picker
	call ddu#start(#{
	\   ui: 'ff',
	\   sources: [#{name: 'cmdl'}],
	\   uiOptions: #{ff: #{prompt: '> '}},
	\   kindOptions: #{
	\     cmdl: #{defaultAction: 'execute'},
	\   },
	\ })
<
Keymaps inside the ddu-ui-ff buffer: >

	call ddu#ui#ff#execute('itemAction', #{name: 'execute'})  " <CR>
	call ddu#ui#ff#execute('itemAction', #{name: 'add'})      " a
	call ddu#ui#ff#execute('itemAction', #{name: 'edit'})     " e
	call ddu#ui#ff#execute('itemAction', #{name: 'delete'})   " d
<
Lua (lazy.nvim + ddu.vim): >

	vim.keymap.set('n', '<leader>C', function()
	  vim.fn['ddu#start']({
	    ui = 'ff',
	    sources = {{ name = 'cmdl' }},
	    kindOptions = {
	      cmdl = { defaultAction = 'execute' },
	    },
	  })
	end)
<
==============================================================================
vim:tw=78:ts=8:ft=help:norl:
